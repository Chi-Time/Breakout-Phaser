var BootState=function(e){};BootState.prototype={preload:function(){game.load.bitmapFont("mainFont","assets/fonts/mainFont.png","assets/fonts/mainFont.fnt")},create:function(){this.startPreload()},startPreload:function(){game.state.start("Preload")}};var PreloadState=function(e){};PreloadState.prototype={preload:function(){game.load.atlas("breakout","assets/sprites/breakout.png","assets/sprites/breakout.json"),game.load.image("starfield","assets/sprites/background.png"),game.load.audio("BGM","assets/audio/Infinite Sensations.ogg"),game.load.audio("paddleHit","assets/audio/paddleHit.ogg"),game.load.audio("brickHit","assets/audio/brickHit.ogg"),game.load.audio("powerup","assets/audio/powerup.ogg"),game.load.audio("death","assets/audio/death.ogg");var e=new BitmapText(game.world.centerX+10,500,.5,.5,"mainFont","loading...",15);game.add.existing(e)},create:function(){this.showMenu()},showMenu:function(){game.state.start("Menu")}};var MenuState=function(e){};MenuState.prototype={create:function(){game.input.onDown.add(this.startGame),startFieldBackground=game.add.tileSprite(0,0,800,600,"starfield");var e=new BitmapText(game.world.centerX,100,.5,.5,"mainFont","BREAKOUT CLONE",40);game.add.existing(e);var a=new BitmapText(game.world.centerX+30,400,.5,.5,"mainFont","- Click to continue - \n - Press 'm' to mute music -",20);game.add.existing(a);var t=new BitmapText(game.world.centerX+10,500,.5,.5,"mainFont","Made by James Johnson, Audio: Sansabich, Graphics: Phaser examples library",15);game.add.existing(t)},startGame:function(){game.state.start("Game")}};var GameState=function(e){};GameState.prototype={create:function(){this.initGameDefaults(),this.initObjects(),this.initAudio(),this.initInput(),this.initUI()},initGameDefaults:function(){ballOnPaddle=!0,lives=3,score=0,game.physics.startSystem(Phaser.Physics.ARCADE),game.physics.arcade.checkCollision.down=!1},initObjects:function(){startFieldBackground=game.add.tileSprite(0,0,800,600,"starfield"),paddle=new Paddle(game.world.centerX,500,.5,.5,"breakout","paddle_big.png"),game.add.existing(paddle),ball=new Ball(game.world.centerX,paddle.y-16,.5,.5,"breakout","ball_1.png"),game.add.existing(ball),fakeBall=new FakeBall(0,0,.5,.5,"breakout","ball_1.png"),game.add.existing(fakeBall),fakeBall.kill(),bricksGroup=game.add.group(),this.spawnBricks()},spawnBricks:function(){for(var e,a=0;4>a;a++)for(var t=0;15>t;t++)e=new Brick(150+36*t,100+52*a,.5,.5,"breakout","brick_"+(a+1)+"_1.png"),bricksGroup.add(e)},initAudio:function(){musicExists||(bgm=game.add.audio("BGM",.5,!0),bgm.play(),musicExists=!0),paddleBounceSFX=game.add.audio("paddleHit",.45),breakSFX=game.add.audio("brickHit",.4),powerupSFX=game.add.audio("powerup",.4),deathSFX=game.add.audio("death",.5)},initInput:function(){startBallKey=game.input.keyboard.addKey(Phaser.Keyboard.SPACEBAR),muteAudioKey=game.input.keyboard.addKey(Phaser.Keyboard.M),muteAudioKey.onDown.add(this.muteAudio),pauseGameKey=game.input.keyboard.addKey(Phaser.Keyboard.ESC),pauseGameKey.onDown.add(this.pauseGame)},initUI:function(){scoreText=new BitmapText(32,550,0,0,"mainFont","score: 0",20),game.add.existing(scoreText),livesText=new BitmapText(680,550,0,0,"mainFont","lives: 3",20),game.add.existing(livesText),introText=new BitmapText(game.world.centerX,400,.5,.5,"mainFont","- press 'space' to begin -",20),game.add.existing(introText)},update:function(){this.pollUserInput(),startFieldBackground.tilePosition.x+=2},pollUserInput:function(){startBallKey.isDown&&ballOnPaddle&&(ball.releaseBallFromPaddle(),introText.visible=!1)},muteAudio:function(){audioIsMuted=!audioIsMuted,audioIsMuted?(bgm.mute=audioIsMuted,console.log("Audio unmuted.")):(bgm.mute=audioIsMuted,console.log("Audio muted."))},pauseGame:function(){game.physics.arcade.isPaused=game.physics.arcade.isPaused?!1:!0},nextWave:function(){bricksGroup.callAll("revive")},gameOver:function(){game.state.start("GameOver")}};var GameOverState=function(e){};GameOverState.prototype={create:function(){startFieldBackground=game.add.tileSprite(0,0,800,600,"starfield");var e=new BitmapText(game.world.centerX,100,.5,.5,"mainFont","GAME OVER",30);game.add.existing(e);var a=new BitmapText(game.world.centerX+10,300,.5,.5,"mainFont","Your final score is: "+score,20);game.add.existing(a);var t=new BitmapText(game.world.centerX,500,.5,.5,"mainFont","- Click to restart -",20);game.add.existing(t),game.input.onDown.add(this.restart)},update:function(){startFieldBackground.tilePosition.y+=2},restart:function(){game.state.start("Game")}};var Paddle=function(e,a,t,i,o,s){Phaser.Sprite.call(this,game,e,a,o,s),game.physics.enable(this,Phaser.Physics.ARCADE),this.anchor.set(t,i),this.body.collideWorldBounds=!0,this.body.bounce.set(1),this.body.immovable=!0,this.takeLife=function(){lives--,livesText.text="lives: "+lives},this.addLife=function(){lives++,livesText.text="lives: "+lives}};Paddle.prototype=Object.create(Phaser.Sprite.prototype),Paddle.prototype.constructor=Paddle,Paddle.prototype.update=function(){paddle.x=game.input.x,paddle.x<24?paddle.x=24:paddle.x>game.width-24&&(paddle.x=game.width-24)};var Brick=function(e,a,t,i,o,s){Phaser.Sprite.call(this,game,e,a,o,s),game.physics.enable(this,Phaser.Physics.ARCADE),this.anchor.setTo(t,i),this.body.bounce.set(1),this.body.immovable=!0};Brick.prototype=Object.create(Phaser.Sprite.prototype),Brick.prototype.constructor=Brick;var Ball=function(e,a,t,i,o,s){Phaser.Sprite.call(this,game,e,a,o,s),game.physics.enable(this,Phaser.Physics.ARCADE),this.anchor.setTo(t,i),this.checkWorldBounds=!0,this.body.collideWorldBounds=!0,this.body.bounce.set(1),this.animations.add("spin",["ball_1.png","ball_2.png","ball_3.png","ball_4.png","ball_5.png"],50,!0,!1),this.increaseScore=function(e){score+=e,score%2e3==0&&paddle.addLife(),scoreText.UpdateText("score: "+score)},this.stillInPlay=function(){0===lives?(GameState.prototype.gameOver(),ballOnPaddle=!1,fakeBall.kill()):(this.reset(paddle.body.x,paddle.y-16),ballOnPaddle=!0,this.animations.stop())},this.ballOutOfBounds=function(){paddle.takeLife(),this.stillInPlay(),deathSFX.play()},this.releaseBallFromPaddle=function(){ballOnPaddle=!1,this.body.velocity.y=-300,this.body.velocity.x=-75,this.animations.play("spin")},this.ballHitPaddle=function(e,a){var t=0;e.x<a.x?(t=a.x-e.x,e.body.velocity.x=-10*t):e.x>a.x?(t=e.x-a.x,e.body.velocity.x=10*t):e.body.velocity.x=2+12*Math.random(),paddleBounceSFX.play()},this.ballHitBrick=function(e,a){a.kill(),this.powerupSelect(e),this.increaseScore(10),this.checkForWaveClear(),breakSFX.play()},this.checkForWaveClear=function(){0==bricksGroup.countLiving()&&(this.increaseScore(1e3),this.waveOver())},this.waveOver=function(){ballOnPaddle=!0,ball.body.velocity.set(0),ball.x=paddle.x+16,ball.y=paddle.y-16,ball.animations.stop(),fakeBall.kill(),isFakeInPlay=!1,GameState.prototype.nextWave()},this.powerupSelect=function(e){var a=Math.floor(11*Math.random())+0;switch(a){case 5:fakeBall.spawnBall(e.x,e.y),powerupSFX.play();break;default:return}},this.events.onOutOfBounds.add(this.ballOutOfBounds,this)};Ball.prototype=Object.create(Phaser.Sprite.prototype),Ball.prototype.constructor=Ball,Ball.prototype.update=function(){ballOnPaddle?this.body.x=paddle.x:(game.physics.arcade.collide(ball,paddle,this.ballHitPaddle,null,this),game.physics.arcade.collide(ball,bricksGroup,this.ballHitBrick,null,this),game.physics.arcade.collide(ball,fakeBall,null,null,this))};var FakeBall=function(e,a,t,i,o,s){Phaser.Sprite.call(this,game,e,a,o,s),game.physics.enable(this,Phaser.Physics.ARCADE),this.anchor.setTo(t,i),this.checkWorldBounds=!0,this.body.collideWorldBounds=!0,this.body.bounce.set(1),this.animations.add("spin",["ball_1.png","ball_2.png","ball_3.png","ball_4.png","ball_5.png"],50,!0,!1),this.increaseScore=function(e){score+=e,score%2e3==0&&paddle.addLife(),scoreText.UpdateText("score: "+score)},this.ballOutOfBounds=function(){this.kill(),isFakeInPlay=!1},this.spawnBall=function(e,a){isFakeInPlay||(this.reset(e,a),this.body.velocity.y=-300,this.body.velocity.x=-75,this.animations.play("spin"),isFakeInPlay=!0)},this.ballHitPaddle=function(e,a){var t=0;e.x<a.x?(t=a.x-e.x,e.body.velocity.x=-10*t):e.x>a.x?(t=e.x-a.x,e.body.velocity.x=10*t):e.body.velocity.x=2+12*Math.random(),paddleBounceSFX.play()},this.ballHitBrick=function(e,a){a.kill(),this.increaseScore(10),ball.checkForWaveClear(),breakSFX.play()},this.events.onOutOfBounds.add(this.ballOutOfBounds,this)};FakeBall.prototype=Object.create(Phaser.Sprite.prototype),FakeBall.prototype.constructor=FakeBall,FakeBall.prototype.update=function(){game.physics.arcade.collide(fakeBall,paddle,this.ballHitPaddle,null,this),game.physics.arcade.collide(fakeBall,bricksGroup,this.ballHitBrick,null,this)};var BitmapText=function(e,a,t,i,o,s,l){Phaser.BitmapText.call(this,game,e,a,o,s,l),this.anchor.setTo(t,i),this.UpdateText=function(e){this.text=e}};BitmapText.prototype=Object.create(Phaser.BitmapText.prototype),BitmapText.prototype.constructor=BitmapText;var ball={},fakeBall={},paddle={},bricksGroup={},scoreText={},livesText={},introText={},fpsText={},startFieldBackground={},ballOnPaddle=!0,isFakeInPlay=!1,musicExists=!1,audioIsMuted=!1,lives=3,score=0,startBallKey={},muteAudioKey={},pauseGameKey={},bgm={},deathSFX={},paddleBounceSFX={},bounceSFX={},powerupSFX={},breakSFX={},gameOverSFX={},game=new Phaser.Game(800,600,Phaser.AUTO);game.state.add("Boot",BootState),game.state.add("Preload",PreloadState),game.state.add("Menu",MenuState),game.state.add("Game",GameState),game.state.add("GameOver",GameOverState),game.state.start("Boot");